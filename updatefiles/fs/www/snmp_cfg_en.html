<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
	<title>SNMP CONFIG</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<link href="include/css_en_imx28x.css" rel="stylesheet" type="text/css" />
	<!--[if lte IE 6]>
		<link href="include/ie6_css_imx28x.css" rel="stylesheet" type="text/css" />
		<![endif]-->
	<script language="JavaScript" type="text/javascript" src="js/msg_mw_en.js"></script>
	<script language="JavaScript" type="text/javascript" src="js/linux_en_imx28x.js"></script>
	<script language="JavaScript" type="text/javascript" src="js/func.js"></script>
	<script language="JavaScript" type="text/javascript" src="js/func_ex.js"></script>
	<script language="JavaScript">
<!--

var view_count = 0, comm_count = 0, user_count = 0, trap_v1v2_count = 0, trap_v3_count = 0;

function setSNMP()
{
    var cf = document.forms[0];
	var dflag = (getRadioCheckedValue(cf.snmp_enable) == "disable");
	setDisabled(dflag,cf.snmp_version[0],cf.snmp_version[1]);
	setDisabled(dflag,cf.snmp_view_name, cf.snmp_view_type[0], cf.snmp_view_type[1], cf.snmp_view_oid, cf.view_add, cf.view_del);
	setDisabled(dflag,cf.snmp_community_name, cf.snmp_community_type[0], cf.snmp_community_type[1], cf.snmp_community_view, cf.comm_add, cf.comm_del);
	setDisabled(dflag,cf.snmp_user_name, cf.snmp_user_type[0], cf.snmp_user_type[1], cf.snmp_user_view, cf.sec_level, cf.auth_algorithm, 
		cf.auth_passwd, cf.encryption_algorithm, cf.encryption_passwd, cf.user_add, cf.user_del);
	setDisabled(dflag,cf.snmpv1v2_trap_ip, cf.snmp_trap_comm,cf.trap_version, cf.trap_comm_add, cf.trap_comm_del);
	setDisabled(dflag,cf.snmpv3_trap_ip, cf.snmp_trap_user, cf.snmp_trap_engineid, cf.trap_sec_level, cf.trap_auth_algorithm, cf.trap_auth_passwd, 
		cf.trap_encryption_algorithm, cf.trap_encryption_passwd, cf.trap_user_add, cf.trap_user_del);

	sec_level_change(cf.sec_level);
	trap_sec_level_change(cf.trap_sec_level);
	setVersion();
		
}

function setVersion()
{
	var cf = document.forms[0];
	var dflag = (getRadioCheckedValue(cf.snmp_version) == "v1/v2c");

	/*if(dflag == true)//v1/v2c
	{
		document.getElementById("div_v1/v2c").style.display = "";
		document.getElementById("v1/v2c").style.display = "";
		document.getElementById("div_trap_v1/v2c").style.display = "";
		document.getElementById("trap_v1/v2c").style.display = "";
		document.getElementById("div_v3").style.display = "";
		document.getElementById("v3").style.display = "";
		document.getElementById("div_trap_v3").style.display = "";
		document.getElementById("trap_v3").style.display = "";
		cf.h_snmp_version.value = "v1/v2c";
	}
	else//v3
	{
		document.getElementById("div_v1/v2c").style.display = "";
		document.getElementById("v1/v2c").style.display = "";
		document.getElementById("div_trap_v1/v2c").style.display = "";
		document.getElementById("trap_v1/v2c").style.display = "";
		document.getElementById("div_v3").style.display = "";
		document.getElementById("v3").style.display = "";
		document.getElementById("div_trap_v3").style.display = "";
		document.getElementById("trap_v3").style.display = "";
		cf.h_snmp_version.value = "v3";
	}*/
}

		function disable_all_intput() {
			var cf = document.forms[0];
			setDisabled(true, cf.snmp_version[0], cf.snmp_version[1]);
			setDisabled(true, cf.snmp_view_name, cf.snmp_view_type[0], cf.snmp_view_type[1], cf.snmp_view_oid, cf.view_add, cf.view_del);
			setDisabled(true, cf.snmp_community_name, cf.snmp_community_type[0], cf.snmp_community_type[1], cf.snmp_community_view, cf.comm_add, cf.comm_del);
			setDisabled(true, cf.snmp_user_name, cf.snmp_user_type[0], cf.snmp_user_type[1], cf.snmp_user_view, cf.sec_level, cf.auth_algorithm,
				cf.auth_passwd, cf.encryption_algorithm, cf.encryption_passwd, cf.user_add, cf.user_del);
			setDisabled(true, cf.snmpv1v2_trap_ip, cf.snmp_trap_comm, cf.trap_version, cf.trap_comm_add, cf.trap_comm_del);
			setDisabled(true, cf.snmpv3_trap_ip, cf.snmp_trap_user, cf.snmp_trap_engineid, cf.trap_sec_level, cf.trap_auth_algorithm, cf.trap_auth_passwd,
				cf.trap_encryption_algorithm, cf.trap_encryption_passwd, cf.trap_user_add, cf.trap_user_del);
			setDisabled(true, cf.Save, cf.Cancel);
			setDisabled(true, cf.snmp_enable[0], cf.snmp_enable[1]);
			//cf.snmp_setcomm.value = "********";
			setVersion();
		}

		function init() {
			var cf = document.forms[0];
			var t = 0, tmp, i = 0;
			var view_array = new Array();
			view_array = cf.snmp_view.value.split(";");
			var flag = false;
			show_language_flag();
			if (cf.loader.value != "admin")
				flag = true;

			while (t < (view_array.length - 1)) {
				var view = new Array();
				view = view_array[t].split(":");

				tmp = "--" + (t + 1);
				for (i = fucCheckLength(tmp); i < 6; i++)
					tmp += "-";
				if (i == 6)
					tmp += "---------------";

				//view name:type:oid
				tmp += view[0];
				for (i = fucCheckLength(view[0]); i < 16; i++)
					tmp += "-";
				if (i == 16)
					tmp += "--------";

				if (view[1] == 0) {
					tmp += "included";
					for (i = fucCheckLength("included"); i < 16; i++)
						tmp += "-";
					if (i == 16)
						tmp += "--------";
				}
				else {
					tmp += "excluded";
					for (i = fucCheckLength("excluded"); i < 16; i++)
						tmp += "-";
					if (i == 16)
						tmp += "--------";
				}


				tmp += view[2];
				for (i = fucCheckLength(view[2]); i < 16; i++)
					tmp += "-";
				if (i == 16)
					tmp += "--------";

				tmp += "-----------------------------------------------";

				cf.view_list.options.add(new Option(tmp, view_array[t]));
				t++;
				view_count++;
			}

			t = 0; i = 0; tmp = "";
			var comm_array = new Array();
			comm_array = cf.snmp_v1v2c.value.split(";");
			while (t < (comm_array.length - 1)) {
				var comm = new Array();
				comm = comm_array[t].split(":");

				tmp = "--" + (t + 1);
				for (i = fucCheckLength(tmp); i < 6; i++)
					tmp += "-";
				if (i == 6)
					tmp += "---------------";

				//comm name:type:view
				if (flag == true && comm[1] == 1) {
					tmp += "********";
					for (i = fucCheckLength("********"); i < 16; i++)
						tmp += "-";
					if (i == 16)
						tmp += "--------";
				}
				else {
					tmp += comm[0];
					for (i = fucCheckLength(comm[0]); i < 16; i++)
						tmp += "-";
					if (i == 16)
						tmp += "--------";
				}

				if (comm[1] == 0) {
					tmp += "rocommunity";
					for (i = fucCheckLength("rocommunity"); i < 16; i++)
						tmp += "-";
					if (i == 16)
						tmp += "--------";
				}
				else {
					tmp += "rwcommunity";
					for (i = fucCheckLength("rwcommunity"); i < 16; i++)
						tmp += "-";
					if (i == 16)
						tmp += "--------";
				}

				tmp += comm[2];
				for (i = fucCheckLength(comm[2]); i < 16; i++)
					tmp += "-";
				if (i == 16)
					tmp += "--------";
				tmp += "-----------------------------------------------";

				cf.comm_list.options.add(new Option(tmp, comm_array[t]));
				t++;
				comm_count++;
			}

			t = 0; i = 0; tmp = "";
			var user_array = new Array();
			user_array = cf.snmp_v3.value.split(";");
			while (t < (user_array.length - 1)) {
				var user = new Array();
				user = user_array[t].split(":");

				tmp = "--" + (t + 1);
				for (i = fucCheckLength(tmp); i < 6; i++)
					tmp += "-";
				if (i == 6)
					tmp += "-";
				//user name:type:view:sec_level:auth:auth_passwd:encryption:encryption_passwd
				tmp += user[0];
				for (i = fucCheckLength(user[0]); i < 16; i++)
					tmp += "-";
				if (i == 16)
					tmp += "--";

				if (user[1] == 0) {
					tmp += "rouser";
					for (i = fucCheckLength("rouser"); i < 12; i++)
						tmp += "-";
					if (i == 12)
						tmp += "--";
				}
				else {
					tmp += "rwuser";
					for (i = fucCheckLength("rwuser"); i < 12; i++)
						tmp += "-";
					if (i == 12)
						tmp += "--";
				}

				tmp += user[2];
				for (i = fucCheckLength(user[2]); i < 16; i++)
					tmp += "-";
				if (i == 16)
					tmp += "--";

				if (user[3] == 0) {
					tmp += "noAuthNoPriv";
					for (i = fucCheckLength("noAuthNoPriv"); i < 12; i++)
						tmp += "-";
					if (i == 12)
						tmp += "--";
				}
				else if (user[3] == 1) {
					tmp += "authNoPriv";
					for (i = fucCheckLength("authNoPriv"); i < 12; i++)
						tmp += "-";
					if (i == 12)
						tmp += "--";
				}
				else if (user[3] == 2) {
					tmp += "authPriv";
					for (i = fucCheckLength("authPriv"); i < 12; i++)
						tmp += "-";
					if (i == 12)
						tmp += "--";
				}

				if (user[4] == 0) {
					tmp += "md5";
					for (i = fucCheckLength("md5"); i < 12; i++)
						tmp += "-";
					if (i == 12)
						tmp += "--";
				}
				else if (user[4] == 1) {
					tmp += "sha";
					for (i = fucCheckLength("sha"); i < 12; i++)
						tmp += "-";
					if (i == 12)
						tmp += "--";
				}

				if (flag == true && user[1] == 1) {
					tmp += "********";
					for (i = fucCheckLength("********"); i < 16; i++)
						tmp += "-";
					if (i == 16)
						tmp += "--";
				}
				else {
					tmp += user[5];
					for (i = fucCheckLength(user[5]); i < 16; i++)
						tmp += "-";
					if (i == 16)
						tmp += "--";
				}

				if (user[6] == 0) {
					tmp += "des";
					for (i = fucCheckLength("des"); i < 12; i++)
						tmp += "-";
					if (i == 12)
						tmp += "--";
				}
				else if (user[6] == 1) {
					tmp += "aes";
					for (i = fucCheckLength("aes"); i < 12; i++)
						tmp += "-";
					if (i == 12)
						tmp += "--";
				}

				if (flag == true && user[1] == 1) {
					tmp += "********";
					for (i = fucCheckLength("********"); i < 16; i++)
						tmp += "-";
					if (i == 16)
						tmp += "--";
				}
				else {
					tmp += user[7];
					for (i = fucCheckLength(user[7]); i < 16; i++)
						tmp += "-";
					if (i == 16)
						tmp += "--";
				}
				tmp += "-----------------------------------------------";

				cf.user_list.options.add(new Option(tmp, user_array[t]));
				t++;
				user_count++;
			}

			t = 0; i = 0; tmp = "";
			var trap_v1v2__array = new Array();
			trap_v1v2__array = cf.snmp_v1v2c_trap.value.split(";");
			while (t < (trap_v1v2__array.length - 1)) {
				var trap_v1v2 = new Array();
				trap_v1v2 = trap_v1v2__array[t].split(":");

				tmp = "--" + (t + 1);
				for (i = fucCheckLength(tmp); i < 6; i++)
					tmp += "-";
				if (i == 6)
					tmp += "---------------";
				//trap_v1v2 ip:comm:version
				tmp += trap_v1v2[0];
				for (i = fucCheckLength(trap_v1v2[0]); i < 16; i++)
					tmp += "-";
				if (i == 16)
					tmp += "--------";

				tmp += trap_v1v2[1];
				for (i = fucCheckLength(trap_v1v2[1]); i < 16; i++)
					tmp += "-";
				if (i == 16)
					tmp += "--------";

				if (trap_v1v2[2] == 0) {
					tmp += "v1";
					for (i = fucCheckLength("v1"); i < 16; i++)
						tmp += "-";
					if (i == 16)
						tmp += "--------";
				}
				else if (trap_v1v2[2] == 1) {
					tmp += "v2c";
					for (i = fucCheckLength("v2c"); i < 16; i++)
						tmp += "-";
					if (i == 16)
						tmp += "--------";
				}
				tmp += "-------------------------------------------------------------------";
				cf.trap_v1v2_list.options.add(new Option(tmp, trap_v1v2__array[t]));
				t++;
				trap_v1v2_count++;
			}

			t = 0; i = 0; tmp = "";
			var trap_v3_array = new Array();
			trap_v3_array = cf.snmp_v3_trap.value.split(";");
			while (t < (trap_v3_array.length - 1)) {
				var trap_v3 = new Array();
				trap_v3 = trap_v3_array[t].split(":");

				tmp = "-" + (t + 1);
				for (i = fucCheckLength(tmp); i < 5; i++)
					tmp += "-";
				if (i == 5)
					tmp += "";

				//trap_v3 ip:user:sec_level:auth:auth_passwd:encryption:encryption_passwd
				tmp += trap_v3[0];
				for (i = fucCheckLength(trap_v3[0]); i < 16; i++)
					tmp += "-";
				if (i == 16)
					tmp += "-";

				tmp += trap_v3[1];
				for (i = fucCheckLength(trap_v3[1]); i < 16; i++)
					tmp += "-";
				if (i == 16)
					tmp += "--";

				if (trap_v3[2] == 0) {
					tmp += "noAuthNoPriv";
					for (i = fucCheckLength("noAuthNoPriv"); i < 12; i++)
						tmp += "-";
					if (i == 12)
						tmp += "--";
				}
				else if (trap_v3[2] == 1) {
					tmp += "authNoPriv";
					for (i = fucCheckLength("authNoPriv"); i < 12; i++)
						tmp += "-";
					if (i == 12)
						tmp += "--";
				}
				else if (trap_v3[2] == 2) {
					tmp += "authPriv";
					for (i = fucCheckLength("authPriv"); i < 12; i++)
						tmp += "-";
					if (i == 12)
						tmp += "--";
				}

				if (trap_v3[3] == 0) {
					tmp += "md5";
					for (i = fucCheckLength("md5"); i < 6; i++)
						tmp += "-";
					if (i == 6)
						tmp += "-";
				}
				else if (trap_v3[3] == 1) {
					tmp += "sha";
					for (i = fucCheckLength("sha"); i < 6; i++)
						tmp += "-";
					if (i == 6)
						tmp += "-";
				}

				tmp += trap_v3[4];
				for (i = fucCheckLength(trap_v3[4]); i < 16; i++)
					tmp += "-";
				if (i == 16)
					tmp += "--";

				if (trap_v3[5] == 0) {
					tmp += "des";
					for (i = fucCheckLength("des"); i < 6; i++)
						tmp += "-";
					if (i == 6)
						tmp += "-";
				}
				else if (trap_v3[5] == 1) {
					tmp += "aes";
					for (i = fucCheckLength("aes"); i < 6; i++)
						tmp += "-";
					if (i == 6)
						tmp += "-";
				}

				tmp += trap_v3[6];
				for (i = fucCheckLength(trap_v3[6]); i < 16; i++)
					tmp += "-";
				if (i == 16)
					tmp += "--";

				tmp += trap_v3[7];
				for (i = fucCheckLength(trap_v3[7]); i < 32; i++)
					tmp += "-";
				if (i == 32)
					tmp += "--";
				tmp += "-----------------------------------------------";

				cf.trap_v3_list.options.add(new Option(tmp, trap_v3_array[t]));
				t++;
				trap_v3_count++;
			}

			dataToVisible(cf);

			if (cf.loader.value != "admin")
				disable_all_intput();
			else
				setSNMP();
		}

		function addViewListItem() {
			var cf = document.forms[0];
			var msg = "", check = new Array();
			var i = 0, t = 0, type;
			var sn_str = "";

			var tmp = cf.snmp_view_name.value;
			for (i = fucCheckLength(cf.snmp_view_name.value); i < 16; i++)
				tmp += "-";
			if (i == 16)
				tmp += "--------";

			if (getRadioCheckedValue(cf.snmp_view_type) == "included") {
				tmp += "included";
				type = 0;
				for (i = fucCheckLength("included"); i < 16; i++)
					tmp += "-";
			}
			else {

				tmp += "excluded";
				type = 1;
				for (i = fucCheckLength("excluded"); i < 16; i++)
					tmp += "-";
			}
			if (i == 16)
				tmp += "--------";

			tmp += cf.snmp_view_oid.value;
			for (i = fucCheckLength(cf.snmp_view_oid.value); i < 16; i++)
				tmp += "-";
			if (i == 16)
				tmp += "--------";
			tmp += "--------------------------------------------";

			if (isBlank(cf.snmp_view_name.value))
				msg += addstr(msg_blank, msg_snmp_view_nme);
			else if (isIllegal(cf.snmp_view_name.value) == false)
				msg += addstr(msg_invalid_num, msg_snmp_view_nme);



			if (isBlank(cf.snmp_view_oid.value))
				msg += addstr(msg_blank, msg_snmp_view_oid);
			else if (isIllegalOid(cf.snmp_view_oid.value) == false)
				msg += addstr(msg_invalid_oid, msg_snmp_view_oid);

			if (msg == "") {
				for (t = 1; t < cf.view_list.options.length; t++) {
					check = cf.view_list.options[t].value.split(":");
					if (cf.snmp_view_name.value == check[0] && type == check[1] && cf.snmp_view_oid.value == check[2]) {
						msg += "The same view entry already exists, please fill in and add again!";
						return checkMsg(msg);
					}
					if (cf.snmp_view_name.value == check[0] && cf.snmp_view_oid.value == check[2]) {
						msg += "The same oid can not set 'included' and 'excluded' in the same view!";
						return checkMsg(msg);
					}
				}

				if (view_count >= 20) {
					msg += "You can add up to 20 view entries!";
					return checkMsg(msg);
				}

				sn_str = "--" + t;
				for (i = fucCheckLength(sn_str); i < 6; i++)
					sn_str += "-";
				if (i == 6)
					sn_str += "---------------";


				tmp = sn_str + tmp;
				cf.view_list.options.add(new Option(tmp, cf.snmp_view_name.value + ":" + type + ":" + cf.snmp_view_oid.value));
				view_count++;

			}

			return checkMsg(msg);
		}

		function addCommListItem() {
			var cf = document.forms[0];
			var msg = "", check = new Array();
			var i = 0, modify = 0, t = 0, type;
			var sn_str = "";
			var flag = false;
			var temp;

			var tmp = cf.snmp_community_name.value;
			for (i = fucCheckLength(cf.snmp_community_name.value); i < 16; i++)
				tmp += "-";
			if (i == 16)
				tmp += "--------";

			if (getRadioCheckedValue(cf.snmp_community_type) == "rocommunity") {
				tmp += "rocommunity";
				type = 0;
				for (i = fucCheckLength("rocommunity"); i < 16; i++)
					tmp += "-";
			}
			else {

				tmp += "rwcommunity";
				type = 1;
				for (i = fucCheckLength("rwcommunity"); i < 16; i++)
					tmp += "-";
			}
			if (i == 16)
				tmp += "--------";

			temp = isBlank(cf.snmp_community_view.value) ? "########" : cf.snmp_community_view.value;
			tmp += temp;
			for (i = fucCheckLength(temp); i < 16; i++)
				tmp += "-";
			if (i == 16)
				tmp += "--------";
			tmp += "--------------------------------------------";

			if (isBlank(cf.snmp_community_name.value))
				msg += addstr(msg_blank, msg_snmp_comm_name);
			if (isIllegal(cf.snmp_community_name.value) == false)
				msg += addstr(msg_invalid_num, msg_snmp_comm_name);

			if (!isBlank(cf.snmp_community_view.value)) {
				flag = false;
				for (t = 1; t < cf.view_list.options.length; t++) {
					check = cf.view_list.options[t].value.split(":");
					if (cf.snmp_community_view.value == check[0]) {
						flag = true;
						break;
					}
				}

				if (flag == false) {

					msg += "View name does not exist, please fill in again!";
				}
			}

			if (msg == "") {
				modify = 0;
				for (t = 1; t < cf.comm_list.options.length; t++) {
					check = cf.comm_list.options[t].value.split(":");
					if (cf.snmp_community_name.value == check[0]) {
						flag = confirm("Community name already exists, do you want to overwrite it?");
						if (flag == true) {
							sn_str = "--" + t;
							for (i = fucCheckLength(sn_str); i < 6; i++)
								sn_str += "-";
							if (i == 6)
								sn_str += "---------------";
							cf.comm_list.options[t].text = sn_str + tmp;
							cf.comm_list.options[t].value = cf.snmp_community_name.value + ":" + type + ":" + (isBlank(cf.snmp_community_view.value) ? "########" : cf.snmp_community_view.value);
							modify = 1;
						}
						else
							return false;
					}
				}

				if (modify == 0) {
					if (comm_count >= 20) {
						msg += "Up to 20 community entries can be added!";
						return checkMsg(msg);
					}

					sn_str = "--" + t;
					for (i = fucCheckLength(sn_str); i < 6; i++)
						sn_str += "-";
					if (i == 6)
						sn_str += "---------------";

					tmp = sn_str + tmp;
					cf.comm_list.options.add(new Option(tmp, cf.snmp_community_name.value + ":" + type + ":" + (isBlank(cf.snmp_community_view.value) ? "########" : cf.snmp_community_view.value)));
					comm_count++;
				}
			}

			return checkMsg(msg);
		}

		function addUserListItem() {
			var cf = document.forms[0];
			var msg = "", check = new Array();
			var i = 0, modify = 0, t = 0, type;
			var sn_str = "";
			var flag = false;
			var temp;

			var tmp = cf.snmp_user_name.value;
			for (i = fucCheckLength(cf.snmp_user_name.value); i < 16; i++)
				tmp += "-";
			if (i == 16)
				tmp += "--";

			if (getRadioCheckedValue(cf.snmp_user_type) == "rouser") {
				tmp += "rouser";
				type = 0;
				for (i = fucCheckLength("rouser"); i < 12; i++)
					tmp += "-";
			}
			else {

				tmp += "rwuser";
				type = 1;
				for (i = fucCheckLength("rwuser"); i < 12; i++)
					tmp += "-";
			}
			if (i == 12)
				tmp += "--";

			temp = isBlank(cf.snmp_user_view.value) ? "########" : cf.snmp_user_view.value;
			tmp += temp;
			for (i = fucCheckLength(temp); i < 16; i++)
				tmp += "-";
			if (i == 16)
				tmp += "--";

			tmp += cf.sec_level.options[cf.sec_level.selectedIndex].text;
			for (i = fucCheckLength(cf.sec_level.options[cf.sec_level.selectedIndex].text); i < 12; i++)
				tmp += "-";
			if (i == 12)
				tmp += "--";

			tmp += cf.auth_algorithm.options[cf.auth_algorithm.selectedIndex].text;
			for (i = fucCheckLength(cf.auth_algorithm.options[cf.auth_algorithm.selectedIndex].text); i < 12; i++)
				tmp += "-";
			if (i == 12)
				tmp += "--";

			temp = isBlank(cf.auth_passwd.value) ? "########" : cf.auth_passwd.value;
			tmp += temp;
			for (i = fucCheckLength(temp); i < 16; i++)
				tmp += "-";
			if (i == 16)
				tmp += "--";

			tmp += cf.encryption_algorithm.options[cf.encryption_algorithm.selectedIndex].text;
			for (i = fucCheckLength(cf.encryption_algorithm.options[cf.encryption_algorithm.selectedIndex].text); i < 12; i++)
				tmp += "-";
			if (i == 12)
				tmp += "--";

			temp = isBlank(cf.encryption_passwd.value) ? "########" : cf.encryption_passwd.value;
			tmp += temp;
			for (i = fucCheckLength(temp); i < 16; i++)
				tmp += "-";
			if (i == 16)
				tmp += "--";

			tmp += "--------------------------------";

			if (isBlank(cf.snmp_user_name.value))
				msg += addstr(msg_blank, msg_snmp_user_name);
			if (isIllegal(cf.snmp_user_name.value) == false)
				msg += addstr(msg_invalid_num, msg_snmp_user_name);

			if (!isBlank(cf.snmp_user_view.value)) {
				flag = false;
				for (t = 1; t < cf.view_list.options.length; t++) {
					check = cf.view_list.options[t].value.split(":");
					if (cf.snmp_user_view.value == check[0]) {
						flag = true;
						break;
					}
				}

				if (flag == false) {

					msg += "View name does not exist, please fill in again!";
				}
			}

			if (cf.sec_level.options[cf.sec_level.selectedIndex].text == "authNoPriv") {
				if (isBlank(cf.auth_passwd.value))
					msg += addstr(msg_blank, msg_snmp_user_authpasswd);
				else if (fucCheckLength(cf.auth_passwd.value) < 8)
					msg += "Password must be 8-16 characters!";
				else if (isIllegal(cf.auth_passwd.value) == false)
					msg += addstr(msg_invalid_num, msg_snmp_user_authpasswd);
			}

			if (cf.sec_level.options[cf.sec_level.selectedIndex].text == "authPriv") {
				if (isBlank(cf.auth_passwd.value))
					msg += addstr(msg_blank, msg_snmp_user_authpasswd);
				else if (fucCheckLength(cf.auth_passwd.value) < 8)
					msg += "Password must be 8-16 characters!";
				else if (isIllegal(cf.auth_passwd.value) == false)
					msg += addstr(msg_invalid_num, msg_snmp_user_authpasswd);

				if (isBlank(cf.encryption_passwd.value))
					msg += addstr(msg_blank, "Encryption password");
				else if (fucCheckLength(cf.encryption_passwd.value) < 8)
					msg += "Password must be 8-16 characters!";
				else if (isIllegal(cf.encryption_passwd.value) == false)
					msg += addstr(msg_invalid_num, "Encryption password");
			}

			if (msg == "") {
				modify = 0;
				for (t = 1; t < cf.user_list.options.length; t++) {
					check = cf.user_list.options[t].value.split(":");
					if (cf.snmp_user_name.value == check[0]) {
						flag = confirm("User name already exists, do you want to overwrite it?");
						if (flag == true) {
							sn_str = "--" + t;
							for (i = fucCheckLength(sn_str); i < 6; i++)
								sn_str += "-";
							if (i == 6)
								sn_str += "-";
							cf.user_list.options[t].text = sn_str + tmp;
							cf.user_list.options[t].value = cf.snmp_user_name.value + ":" + type + ":" + (isBlank(cf.snmp_user_view.value) ? "########" : cf.snmp_user_view.value)
								+ ":" + cf.sec_level.selectedIndex + ":" + cf.auth_algorithm.selectedIndex + ":" + (isBlank(cf.auth_passwd.value) ? "########" : cf.auth_passwd.value)
								+ ":" + cf.encryption_algorithm.selectedIndex + ":" + (isBlank(cf.encryption_passwd.value) ? "########" : cf.encryption_passwd.value);
							modify = 1;
						}
						else
							return false;
					}
				}

				if (modify == 0) {
					if (user_count >= 20) {
						msg += "You can add up to 20 user entries!";
						return checkMsg(msg);
					}

					sn_str = "--" + t;
					for (i = fucCheckLength(sn_str); i < 6; i++)
						sn_str += "-";
					if (i == 6)
						sn_str += "-";

					tmp = sn_str + tmp;
					cf.user_list.options.add(new Option(tmp, cf.snmp_user_name.value + ":" + type + ":" + (isBlank(cf.snmp_user_view.value) ? "########" : cf.snmp_user_view.value)
						+ ":" + cf.sec_level.selectedIndex + ":" + cf.auth_algorithm.selectedIndex + ":" + (isBlank(cf.auth_passwd.value) ? "########" : cf.auth_passwd.value)
						+ ":" + cf.encryption_algorithm.selectedIndex + ":" + (isBlank(cf.encryption_passwd.value) ? "########" : cf.encryption_passwd.value)));
					user_count++;
				}
			}

			return checkMsg(msg);
		}


		function addTrap_v1v2_ListItem() {
			var cf = document.forms[0];
			var msg = "", check = new Array();
			var i = 0, modify = 0, t = 0, type;
			var sn_str = "";
			var flag = false;

			var tmp = cf.snmpv1v2_trap_ip.value;
			for (i = fucCheckLength(cf.snmpv1v2_trap_ip.value); i < 16; i++)
				tmp += "-";
			if (i == 16)
				tmp += "--------";

			tmp += cf.snmp_trap_comm.value;
			for (i = fucCheckLength(cf.snmp_trap_comm.value); i < 16; i++)
				tmp += "-";
			if (i == 16)
				tmp += "--------";

			tmp += cf.trap_version.options[cf.trap_version.selectedIndex].text;
			for (i = fucCheckLength(cf.trap_version.options[cf.trap_version.selectedIndex].text); i < 16; i++)
				tmp += "-";
			if (i == 16)
				tmp += "--------";
			tmp += "------------------------------------------------------------------------";

			if (isBlank(cf.snmpv1v2_trap_ip.value))
				msg += addstr(msg_blank, msg_snmp_trap_ip);
			else if (check_ip(cf.snmpv1v2_trap_ip) == false)
				msg += msg_invalid_snmp_trap;

			if (isBlank(cf.snmp_trap_comm.value))
				msg += addstr(msg_blank, msg_snmp_comm_name);
			else {
				if (isIllegal(cf.snmp_trap_comm.value) == false)
					msg += addstr(msg_invalid_num, msg_snmp_comm_name);
				/*flag = false;
				for(t=1; t < cf.comm_list.options.length; t++)
				{
					check = cf.comm_list.options[t].value.split(":");
					if(cf.snmp_trap_comm.value == check[0])
					{
						flag = true;
						break;
					}
				}
				
				if(flag == false)
				{
		
					msg += "Community name does not exist, please fill in again!";
				}*/
			}

			if (msg == "") {
				modify = 0;
				for (t = 1; t < cf.trap_v1v2_list.options.length; t++) {
					check = cf.trap_v1v2_list.options[t].value.split(":");
					if (cf.snmpv1v2_trap_ip.value == check[0]) {
						flag = confirm("The trap gateway IP address already exists. Do you want to overwrite it?");
						if (flag == true) {
							sn_str = "---" + t;
							for (i = fucCheckLength(sn_str); i < 6; i++)
								sn_str += "-";
							if (i == 6)
								sn_str += "---------------";
							cf.trap_v1v2_list.options[t].text = sn_str + tmp;
							cf.trap_v1v2_list.options[t].value = cf.snmpv1v2_trap_ip.value + ":" + cf.snmp_trap_comm.value + ":" + cf.trap_version.selectedIndex;
							modify = 1;
						}
						else
							return false;
					}
				}

				if (modify == 0) {
					if (trap_v1v2_count >= 20) {
						msg += "A maximum of 20 trap gateway IP address entries can be added!";
						return checkMsg(msg);
					}

					sn_str = "--" + t;
					for (i = fucCheckLength(sn_str); i < 6; i++)
						sn_str += "-";
					if (i == 6)
						sn_str += "---------------";

					tmp = sn_str + tmp;
					cf.trap_v1v2_list.options.add(new Option(tmp, cf.snmpv1v2_trap_ip.value + ":" + cf.snmp_trap_comm.value + ":" + cf.trap_version.selectedIndex));
					trap_v1v2_count++;
				}
			}

			return checkMsg(msg);
		}

		function addTrap_v3_ListItem() {
			var cf = document.forms[0];
			var msg = "", check = new Array();
			var i = 0, modify = 0, t = 0, type;
			var sn_str = "";
			var flag = false;
			var temp;

			var tmp = cf.snmpv3_trap_ip.value;
			for (i = fucCheckLength(cf.snmpv3_trap_ip.value); i < 16; i++)
				tmp += "-";
			if (i == 16)
				tmp += "-";

			tmp += cf.snmp_trap_user.value;
			for (i = fucCheckLength(cf.snmp_trap_user.value); i < 16; i++)
				tmp += "-";
			if (i == 16)
				tmp += "--";

			tmp += cf.trap_sec_level.options[cf.trap_sec_level.selectedIndex].text;
			for (i = fucCheckLength(cf.trap_sec_level.options[cf.trap_sec_level.selectedIndex].text); i < 12; i++)
				tmp += "-";
			if (i == 12)
				tmp += "--";

			tmp += cf.trap_auth_algorithm.options[cf.trap_auth_algorithm.selectedIndex].text;
			for (i = fucCheckLength(cf.trap_auth_algorithm.options[cf.trap_auth_algorithm.selectedIndex].text); i < 6; i++)
				tmp += "-";
			if (i == 6)
				tmp += "-";

			temp = isBlank(cf.trap_auth_passwd.value) ? "########" : cf.trap_auth_passwd.value;
			tmp += temp;
			for (i = fucCheckLength(temp); i < 16; i++)
				tmp += "-";
			if (i == 16)
				tmp += "--";

			tmp += cf.trap_encryption_algorithm.options[cf.trap_encryption_algorithm.selectedIndex].text;
			for (i = fucCheckLength(cf.trap_encryption_algorithm.options[cf.trap_encryption_algorithm.selectedIndex].text); i < 6; i++)
				tmp += "-";
			if (i == 6)
				tmp += "-";

			if (isBlank(cf.trap_encryption_passwd.value) && cf.trap_sec_level.options[cf.trap_sec_level.selectedIndex].text == "authPriv") {
				tmp += cf.trap_auth_passwd.value;
				for (i = fucCheckLength(cf.trap_auth_passwd.value); i < 16; i++)
					tmp += "-";
				if (i == 16)
					tmp += "--";
				cf.trap_encryption_passwd.value = cf.trap_auth_passwd.value;
			}
			else {
				temp = isBlank(cf.trap_encryption_passwd.value) ? "########" : cf.trap_encryption_passwd.value;
				tmp += temp;
				for (i = fucCheckLength(temp); i < 16; i++)
					tmp += "-";
				if (i == 16)
					tmp += "--";
			}

			temp = isBlank(cf.snmp_trap_engineid.value) ? "########" : cf.snmp_trap_engineid.value;
			tmp += temp;
			for (i = fucCheckLength(temp); i < 32; i++)
				tmp += "-";
			if (i == 32)
				tmp += "--";
			tmp += "--------------------------------";

			if (isBlank(cf.snmpv3_trap_ip.value))
				msg += addstr(msg_blank, msg_snmp_trap_ip);
			else if (check_ip(cf.snmpv3_trap_ip) == false)
				msg += msg_invalid_snmp_trap;

			if (isBlank(cf.snmp_trap_user.value))
				msg += addstr(msg_blank, msg_snmp_user_name);
			else {
				if (isIllegal(cf.snmp_trap_user.value) == false)
					msg += addstr(msg_invalid_num, msg_snmp_user_name);

			}

			if (!isBlank(cf.snmp_trap_engineid.value)) {
				if (isIllegalEngineId(cf.snmp_trap_engineid.value) == false) {
					msg += "Invalid engine ID, must be an even number of hexadecimal characters beginning with 0x, and the length is greater than or equal to 10 and less than or equal to 30!";
				}
			}
			else {
				//msg += "Engine ID cannot be empt!";
			}


			if (cf.trap_sec_level.options[cf.trap_sec_level.selectedIndex].text == "authNoPriv") {
				if (isBlank(cf.trap_auth_passwd.value))
					msg += addstr(msg_blank, msg_snmp_user_authpasswd);
				else if (fucCheckLength(cf.trap_auth_passwd.value) < 8)
					msg += "Password must be 8-16 characters!";
				else if (isIllegal(cf.trap_auth_passwd.value) == false)
					msg += addstr(msg_invalid_num, msg_snmp_user_authpasswd);
			}

			if (cf.trap_sec_level.options[cf.trap_sec_level.selectedIndex].text == "authPriv") {
				if (isBlank(cf.trap_auth_passwd.value))
					msg += addstr(msg_blank, msg_snmp_user_authpasswd);
				else if (fucCheckLength(cf.trap_auth_passwd.value) < 8)
					msg += "Password must be 8-16 characters!";
				else if (isIllegal(cf.trap_auth_passwd.value) == false)
					msg += addstr(msg_invalid_num, msg_snmp_user_authpasswd);

				if (isBlank(cf.trap_encryption_passwd.value))
					msg += addstr(msg_blank, "Encryption password");
				else if (fucCheckLength(cf.trap_encryption_passwd.value) < 8)
					msg += "Password must be 8-16 characters!";
				else if (isIllegal(cf.trap_encryption_passwd.value) == false)
					msg += addstr(msg_invalid_num, "Encryption password");
			}



			if (msg == "") {
				modify = 0;
				for (t = 1; t < cf.trap_v3_list.options.length; t++) {
					check = cf.trap_v3_list.options[t].value.split(":");
					if (cf.snmpv3_trap_ip.value == check[0]) {
						flag = confirm("The trap gateway IP address already exists. Do you want to overwrite it?");
						if (flag == true) {
							sn_str = "-" + t;
							for (i = fucCheckLength(sn_str); i < 5; i++)
								sn_str += "-";
							if (i == 5)
								sn_str += "";
							cf.trap_v3_list.options[t].text = sn_str + tmp;
							cf.trap_v3_list.options[t].value = cf.snmpv3_trap_ip.value + ":" + cf.snmp_trap_user.value
								+ ":" + cf.trap_sec_level.selectedIndex + ":" + cf.trap_auth_algorithm.selectedIndex + ":" + (isBlank(cf.trap_auth_passwd.value) ? "########" : cf.trap_auth_passwd.value)
								+ ":" + cf.trap_encryption_algorithm.selectedIndex + ":" + (isBlank(cf.trap_encryption_passwd.value) ? "########" : cf.trap_encryption_passwd.value) + ":" + (isBlank(cf.snmp_trap_engineid.value) ? "########" : cf.snmp_trap_engineid.value);
							modify = 1;
						}
						else
							return false;
					}
				}

				if (modify == 0) {
					if (trap_v3_count >= 20) {
						msg += "A maximum of 20 trap gateway IP address entries can be added!";
						return checkMsg(msg);
					}

					sn_str = "-" + t;
					for (i = fucCheckLength(sn_str); i < 5; i++)
						sn_str += "-";
					if (i == 5)
						sn_str += "";

					tmp = sn_str + tmp;
					cf.trap_v3_list.options.add(new Option(tmp, cf.snmpv3_trap_ip.value + ":" + cf.snmp_trap_user.value
						+ ":" + cf.trap_sec_level.selectedIndex + ":" + cf.trap_auth_algorithm.selectedIndex + ":" + (isBlank(cf.trap_auth_passwd.value) ? "########" : cf.trap_auth_passwd.value)
						+ ":" + cf.trap_encryption_algorithm.selectedIndex + ":" + (isBlank(cf.trap_encryption_passwd.value) ? "########" : cf.trap_encryption_passwd.value) + ":" + (isBlank(cf.snmp_trap_engineid.value) ? "########" : cf.snmp_trap_engineid.value)));
					trap_v3_count++;
				}
			}

			return checkMsg(msg);
		}

		function delViewListItem() {
			var cf = document.forms[0];
			var check = new Array();
			var temp = new Array();
			var t, msg = "";
			var pos = cf.view_list.selectedIndex;
			var flag = false;

			if (pos > 0) {
				check = cf.view_list.options[pos].value.split(":");
				for (t = 1; t < cf.view_list.options.length; t++) {
					if (t != pos) {
						var tmp = new Array();
						tmp = cf.view_list.options[t].value.split(":");
						if (check[0] == tmp[0]) {

							flag = true;
							break;
						}
					}
				}
				if (flag == false) {
					for (t = 1; t < cf.comm_list.options.length; t++) {
						temp = cf.comm_list.options[t].value.split(":");
						if (check[0] == temp[2]) {
							msg += "The view has been referenced in SNMP V1/V2 configuration. Please delete the referenced entry first!";
							return checkMsg(msg);
						}
					}

					for (t = 1; t < cf.user_list.options.length; t++) {
						temp = cf.user_list.options[t].value.split(":");
						if (check[0] == temp[2]) {
							msg += "The view has been referenced in SNMP V3 configuration. Please delete the referenced entry first!";
							return checkMsg(msg);
						}
					}
				}
				cf.view_list.remove(pos);
				view_count--;
			}
			else
				return false;

			return true;
		}

		function delCommListItem() {
			var cf = document.forms[0];
			var check = new Array();
			var temp = new Array();
			var t, msg = "";
			var pos = cf.comm_list.selectedIndex;

			if (pos > 0) {
				/*check = cf.comm_list.options[pos].value.split(":");
				for(t=1; t < cf.trap_v1v2_list.options.length; t++)
				{
					temp = cf.trap_v1v2_list.options[t].value.split(":");
					if(check[0] == temp[1])
					{
						msg += "The community has been referenced in SNMP V1/V2 trap gateway configuration. Please delete the referenced entry first!";
						return checkMsg(msg);
					}
				}*/

				cf.comm_list.remove(pos);
				comm_count--;
			}
			else
				return false;

			return true;
		}

		function delUserListItem() {
			var cf = document.forms[0];
			var check = new Array();
			var temp = new Array();
			var t, msg = "";
			var pos = cf.user_list.selectedIndex;

			if (pos > 0) {
				/*check = cf.user_list.options[pos].value.split(":");
				for(t=1; t < cf.trap_v3_list.options.length; t++)
				{
					temp = cf.trap_v3_list.options[t].value.split(":");
					if(check[0] == temp[1])
					{
						msg += "The user name has been referenced in SNMP V3 trap gateway configuration. Please delete the referenced entry first!";
						return checkMsg(msg);
					}
				}*/

				cf.user_list.remove(pos);
				user_count--;
			}
			else
				return false;

			return true;
		}

		function delTrap_v1v2_ListItem() {
			var cf = document.forms[0];
			var pos = cf.trap_v1v2_list.selectedIndex;

			if (pos > 0) {
				cf.trap_v1v2_list.remove(pos);
				trap_v1v2_count--;
			}
			else
				return false;

			return true;
		}

		function delTrap_v3_ListItem() {
			var cf = document.forms[0];
			var pos = cf.trap_v3_list.selectedIndex;

			if (pos > 0) {
				cf.trap_v3_list.remove(pos);
				trap_v3_count--;
			}
			else
				return false;

			return true;
		}

		function checkData() {
			var cf = document.forms[0];
			var msg = "", tmp = "";
			var t;

			cf.snmp_view.value = "";
			cf.snmp_v1v2c.value = "";
			cf.snmp_v3.value = "";
			cf.snmp_v1v2c_trap.value = "";
			cf.snmp_v3_trap.value = "";

			for (t = 1; t < cf.view_list.options.length; t++)
				cf.snmp_view.value += cf.view_list.options[t].value + ";";

			for (t = 1; t < cf.comm_list.options.length; t++)
				cf.snmp_v1v2c.value += cf.comm_list.options[t].value + ";";

			for (t = 1; t < cf.user_list.options.length; t++)
				cf.snmp_v3.value += cf.user_list.options[t].value + ";";

			for (t = 1; t < cf.trap_v1v2_list.options.length; t++)
				cf.snmp_v1v2c_trap.value += cf.trap_v1v2_list.options[t].value + ";";

			for (t = 1; t < cf.trap_v3_list.options.length; t++)
				cf.snmp_v3_trap.value += cf.trap_v3_list.options[t].value + ";";

			if (cf.trap_v1v2_list.options.length > 1)
				cf.snmp_trap_ip.value = cf.trap_v1v2_list.options[1].value.split(":")[0];
			else
				cf.snmp_trap_ip.value = "";

			dataToHidden(cf);
			return checkMsg(msg);
		}

		function sec_level_change(obj) {
			var cf = document.forms[0];
			var index = obj.selectedIndex;
			if (index == 0) {
				setDisabled(true, cf.auth_algorithm, cf.auth_passwd, cf.encryption_algorithm, cf.encryption_passwd);
				cf.auth_passwd.value = "";
				cf.encryption_passwd.value = "";
			}
			else if (index == 1) {
				setDisabled(false, cf.auth_algorithm, cf.auth_passwd);
				setDisabled(true, cf.encryption_algorithm, cf.encryption_passwd);
				cf.encryption_passwd.value = "";

			}
			else if (index == 2) {
				setDisabled(false, cf.auth_algorithm, cf.auth_passwd, cf.encryption_algorithm, cf.encryption_passwd);
			}

		}

		function trap_sec_level_change(obj) {
			var cf = document.forms[0];
			var index = obj.selectedIndex;
			if (index == 0) {
				setDisabled(true, cf.trap_auth_algorithm, cf.trap_auth_passwd, cf.trap_encryption_algorithm, cf.trap_encryption_passwd);
				cf.trap_auth_passwd.value = "";
				cf.trap_encryption_passwd.value = "";
			}
			else if (index == 1) {
				setDisabled(false, cf.trap_auth_algorithm, cf.trap_auth_passwd);
				setDisabled(true, cf.trap_encryption_algorithm, cf.trap_encryption_passwd);
				cf.trap_encryption_passwd.value = "";
			}
			else if (index == 2) {
				setDisabled(false, cf.trap_auth_algorithm, cf.trap_auth_passwd, cf.trap_encryption_algorithm, cf.trap_encryption_passwd);
			}
		}

		//-->
	</script>
</head>

<body style="margin:0" onload="init()">
	<form method="POST" action="setup.cgi">
		<table width="1002" border="0" align="center" cellspacing="0">
			<tr>
				<td>
					<table width="1002" border="0" cellpadding="0" cellspacing="0" class="body">
						<tr>
							<td height="7" colspan="2" align="left" valign="top" bgcolor="#FFFFFF"></td>
						</tr>
						<tr>
							<td id="logo" width="432" height="67" align="left" valign="top" bgcolor="#FFFFFF"></td>
							<td width="570" height="67" align="right" valign="bottom" bgcolor="#FFFFFF"><a
									href="https://milkv.io/">
									<span class="showbtn3">Website</span>
								</a><a href="./setup.cgi?todo=changeLanguage"><span id='changeLanguage'
										class="showbtn4">中文版</span></a><a href="./setup.cgi?todo=logout"><span
										class="showbtn3">Logout</span><span class="showbtn5">&times;</span></a>
								<br>
								<span class="style6">VISITOR IP：@clinet_ip# &nbsp;VISITOR MAC：@clinet_mac#</p>
									</spen>
							</td>
						</tr>
						<tr>
							<td height="7" colspan="2" align="left" bgcolor="#FFFFFF"></td>
						</tr>
						<tr>
							<table width="1002">
								<script language="JavaScript1.2">init_menu();</script>
							</table>
						</tr>
						<tr>
							<td height="7" colspan="2" align="left" bgcolor="#FFFFFF"></td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
		<table width="1002" border="0" align="center" cellspacing="0">
			<tr>
				<td height="25" align="middle" valign="middle">
					<table width="1002" border="0" cellspacing="0">
						<tr>
							<td height="25" class="table_title"><strong class="style4">&nbsp;&nbsp;Current
									Page&gt;&gt;</strong><span class="style4">Port Config</span><strong
									class="style4">&gt;&gt;</strong><span class="style3">SNMP Config</span></td>
						</tr>
					</table>
				</td>
			</tr>
			<tr align="left" valign="top">
				<td height="25" align="left">
					<table width="1002" height="25" align="center" cellpadding="0" cellspacing="1">
						<tr align="left" valign="top" class="table_enable">
							<td height="25" width="150" valign="middle">&nbsp;&nbsp;SNMP config</td>
							<td height="25" colspan="9" align="left" valign="middle">&nbsp;
								<input type="radio" name="snmp_enable" value="enable" autocomplete="off"
									onClick="setSNMP()">
								enable
								&nbsp;
								<input type="radio" name="snmp_enable" value="disable" autocomplete="off"
									onClick="setSNMP()">
								disable
							</td>
					</table>
				</td>
			</tr>
			<tr align="left" valign="top" style="display:none">
				<td height="25" align="left">
					<table width="1002" height="25" align="center" cellpadding="0" cellspacing="1">
						<tr align="left" valign="top" class="table_enable">
							<td height="25" width="150" valign="middle">&nbsp;&nbsp;SNMP version</td>
							<td height="25" colspan="9" align="left" valign="middle">&nbsp;
								<input type="radio" name="snmp_version" value="v1/v2c" autocomplete="off"
									onClick="setVersion()">
								v1/v2c
								&nbsp;
								<input type="radio" name="snmp_version" value="v3" autocomplete="off"
									onClick="setVersion()">
								v3
							</td>
						</tr>
					</table>
				</td>
			</tr>
			<tr height="8">
				<td width="1001">
					<div style="overflow:hidden;background:#969594;height:1px;"></div>
				</td>
			</tr>
			<tr>
				<td align="middle" valign="middle">
					<table width="1002" border="0" cellpadding="0" cellspacing="1" class="td">
						<tr>
							<td height="25" colspan="3" valign="middle" class="td2">&nbsp;&nbsp;SNMP View config</td>
						</tr>
						<tr>
							<td height="25" valign="middle" class="table_left">&nbsp;&nbsp;View name:
								<input type="text" name="snmp_view_name" value="" maxlength="16" class="input_user" />
							</td>
							<td height="25" align="left" valign="middle" class="table_right">&nbsp;type:
								<input type="radio" name="snmp_view_type" value="included" autocomplete="off"
									checked="true">
								included
								&nbsp;
								<input type="radio" name="snmp_view_type" value="excluded" autocomplete="off">
								excluded
							</td>
							<td valign="middle" align="left" class="table_right">&nbsp;OID:
								<input type="text" name="snmp_view_oid" value="" maxlength="64" class="input_user"
									style="width:400px;" />
							</td>
						</tr>
						<tr>
							<td colspan="3">
								<table width="1002" border="0" cellpadding="0" cellspacing="1" class="td">
									<tr>
										<td width="150" height="25" class="table_left">&nbsp;&nbsp;Processing list</td>
										<td class="table_right">&nbsp;
											<input type="button" name="view_add" value="add" class="showbtn7"
												onClick="return addViewListItem();" />
											<input type="button" name="view_del" value="del" class="showbtn7"
												onClick="return delViewListItem();" />
										</td>
									</tr>
								</table>
							</td>
						</tr>

						<tr>
							<td colspan="3">
								<table width="1002" border="0" cellspacing="1" cellpadding="0">
									<tr height="8">
										<td width="1001">
											<div style="overflow:hidden;background:#969594;height:1px;"></div>
										</td>
									</tr>
									<tr>
										<td>
											<select name="view_list" size="10" id="uselect"
												style="width: 1001px;-webkit-appearance: none; box-shadow: none !important;margin:1px;font-size:12px;font-family:Courier New,sans-serif; color:#333333;">
												<option value="0">
													--No.----------------View--------------------Type--------------------Oid----------------------------------------------------------------------------
												</option>
											</select>
										</td>
									</tr>
								</table>
							</td>
						</tr>

					</table>
				</td>
			</tr>


			<tr height="8" id="div_v1/v2c">
				<td width="1001">
					<div style="overflow:hidden;background:#969594;height:1px;"></div>
				</td>
			</tr>
			<tr>
				<td align="middle" valign="middle" id="v1/v2c">
					<table width="1002" border="0" cellpadding="0" cellspacing="1" class="td">
						<tr>
							<td height="25" colspan="3" valign="middle" class="td2">&nbsp;&nbsp;SNMP v1/v2c config</td>
						</tr>

						<tr>
							<td valign="middle" class="table_left">&nbsp;&nbsp;Community name:
								<input type="text" name="snmp_community_name" value="" maxlength="16"
									class="input_user" />
							</td>
							<td height="25" align="left" valign="middle" class="table_right">&nbsp;Type:
								<input type="radio" name="snmp_community_type" value="rocommunity" autocomplete="off"
									checked="true">
								read-only
								&nbsp;
								<input type="radio" name="snmp_community_type" value="rwcommunity" autocomplete="off">
								read-write
							</td>
							<td valign="middle" class="table_right">&nbsp;View:
								<input type="text" name="snmp_community_view" value="" maxlength="16"
									class="input_user" />
							</td>
						</tr>
						<tr>
							<td colspan="3">
								<table width="1002" border="0" cellpadding="0" cellspacing="1" class="td">
									<tr>
										<td width="150" height="25" class="table_left">&nbsp;&nbsp;Processing list</td>
										<td class="table_right">&nbsp;
											<input type="button" name="comm_add" value="add" class="showbtn7"
												onClick="return addCommListItem();" />
											<input type="button" name="comm_del" value="del" class="showbtn7"
												onClick="return delCommListItem();" />
										</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<td colspan="3">
								<table width="1002" border="0" cellspacing="1" cellpadding="0">
									<tr height="8">
										<td width="1001">
											<div style="overflow:hidden;background:#969594;height:1px;"></div>
										</td>
									</tr>
									<tr>
										<td>
											<select name="comm_list" size="10" id="uselect"
												style="width: 1001px;-webkit-appearance: none; box-shadow: none !important;margin:1px;font-size:12px;font-family:Courier New,sans-serif; color:#333333;">
												<option value="0">
													--No.----------------Community---------------Type--------------------View----------------------------------------------------------------------------
												</option>
											</select>
										</td>
									</tr>
								</table>
							</td>
						</tr>
					</table>
				</td>
			</tr>


			<tr height="8" id="div_v3">
				<td width="1001">
					<div style="overflow:hidden;background:#969594;height:1px;"></div>
				</td>
			</tr>
			<tr>

				<td align="middle" valign="middle" id="v3">
					<table width="1002" border="0" cellpadding="0" cellspacing="1" class="td">
						<tr>
							<td height="25" colspan="8" valign="middle" class="td2">&nbsp;&nbsp;SNMP v3 config</td>
						</tr>

						<tr>
							<td height="25" valign="middle" class="table_left">&nbsp;&nbsp;User name:
								<input type="text" name="snmp_user_name" value="" maxlength="16" class="input_user" />
							</td>
							<td height="25" align="left" valign="middle" class="table_right">&nbsp;Type:
								<input type="radio" name="snmp_user_type" value="rouser" autocomplete="off"
									checked="true">
								read-only
								&nbsp;
								<input type="radio" name="snmp_user_type" value="rwuser" autocomplete="off">
								read-write
							</td>

							<td height="25" valign="middle" class="table_right">&nbsp;View:
								<input type="text" name="snmp_user_view" value="" maxlength="16" class="input_user" />
							</td>

							<td height="25" valign="middle" class="table_right">&nbsp;Security level:
								<select name="sec_level" class="select1" style="width:auto;"
									onchange="sec_level_change(this)">
									<option value="0">noAuthNoPriv</option>
									<option value="1">authNoPriv</option>
									<option value="2">authPriv</option>
								</select>
							</td>

						</tr>
						<tr>
							<td height="25" valign="middle" class="table_right">&nbsp;&nbsp;Authentication algorithm:
								<select name="auth_algorithm" class="select1">
									<option value="0">md5</option>
									<option value="1">sha</option>
								</select>
							</td>

							<td valign="middle" class="table_right">&nbsp;Authentication password:
								<input type="text" name="auth_passwd" value="" maxlength="16" class="input_user" />
							</td>

							<td valign="middle" class="table_right">&nbsp;Encryption algorithm:
								<select name="encryption_algorithm" class="select1">
									<option value="0">des</option>
								</select>
							</td>

							<td valign="middle" class="table_right">&nbsp;Encryption password:
								<input type="text" name="encryption_passwd" value="" maxlength="16"
									class="input_user" />
							</td>
						</tr>
						<tr>
							<td colspan="8">
								<table width="1002" border="0" cellpadding="0" cellspacing="1" class="td">
									<tr>
										<td width="150" height="25" class="table_left">&nbsp;&nbsp;Processing list</td>
										<td class="table_right">&nbsp;
											<input type="button" name="user_add" value="add" class="showbtn7"
												onClick="return addUserListItem();" />
											<input type="button" name="user_del" value="del" class="showbtn7"
												onClick="return delUserListItem();" />
										</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<td colspan="8">
								<table width="1002" border="0" cellspacing="1" cellpadding="0">
									<tr height="8">
										<td width="1001">
											<div style="overflow:hidden;background:#969594;height:1px;"></div>
										</td>
									</tr>
									<tr>
										<td>
											<select name="user_list" size="10" id="uselect"
												style="width: 1001px;-webkit-appearance: none; box-shadow: none !important;margin:1px;font-size:12px;font-family:Courier New,sans-serif; color:#333333;">
												<option value="0">
													--No.--User--------------Type----------View--------------Level---------Auth----------AuthPasswd--------Enc-----------EncPasswd------------------
												</option>
											</select>
										</td>
									</tr>
								</table>
							</td>
						</tr>
					</table>
				</td>
			</tr>


			<tr height="8" id="div_trap_v1/v2c">
				<td width="1001">
					<div style="overflow:hidden;background:#969594;height:1px;"></div>
				</td>
			</tr>
			<tr>

				<td align="middle" valign="middle" id="trap_v1/v2c">
					<table width="1002" border="0" cellpadding="0" cellspacing="1" class="td">
						<tr>
							<td height="25" colspan="3" valign="middle" class="td2">&nbsp;&nbsp;SNMP v1/v2c TRAP Gateway
								config</td>
						</tr>
						<tr>
							<td valign="middle" class="table_right">&nbsp;&nbsp;IP Addr:
								<input type="text" name="snmpv1v2_trap_ip" value="" maxlength="16" class="input_user" />
							</td>

							<td valign="middle" class="table_right">&nbsp;community:
								<input type="text" name="snmp_trap_comm" value="" maxlength="16" class="input_user" />
							</td>

							<td valign="middle" class="table_right">&nbsp;&nbsp;Trap version:
								<select name="trap_version" class="select1">
									<option value="0">v1</option>
									<option value="1">v2c</option>
								</select>
							</td>
						</tr>
						<tr>
							<td colspan="3">
								<table width="1002" border="0" cellpadding="0" cellspacing="1" class="td">
									<tr>
										<td width="150" height="25" class="table_left">&nbsp;&nbsp;Processing list</td>
										<td class="table_right">&nbsp;
											<input type="button" name="trap_comm_add" value="add" class="showbtn7"
												onClick="return addTrap_v1v2_ListItem();" />
											<input type="button" name="trap_comm_del" value="del" class="showbtn7"
												onClick="return delTrap_v1v2_ListItem();" />
										</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<td colspan="3">
								<table width="1002" border="0" cellspacing="1" cellpadding="0">
									<tr height="8">
										<td width="1001">
											<div style="overflow:hidden;background:#969594;height:1px;"></div>
										</td>
									</tr>
									<tr>
										<td>
											<select name="trap_v1v2_list" size="10" id="uselect"
												style="width: 1001px;-webkit-appearance: none; box-shadow: none !important;margin:1px;font-size:12px;font-family:Courier New,sans-serif; color:#333333;">
												<option value="0">--No.----------------GW
													IP-------------------Community--------------Trap
													version--------------------------------------------------------------------------------------
												</option>
											</select>
										</td>
									</tr>
								</table>
							</td>
						</tr>
					</table>
				</td>
			</tr>

			<tr height="8" id="div_trap_v3">
				<td width="1001">
					<div style="overflow:hidden;background:#969594;height:1px;"></div>
				</td>
			</tr>
			<tr>
				<td align="middle" valign="middle" id="trap_v3">
					<table width="1002" border="0" cellpadding="0" cellspacing="1" class="td">
						<tr>
							<td height="25" colspan="7" valign="middle" class="td2">&nbsp;&nbsp;SNMP v3 TRAP Gateway
								config</td>
						</tr>

						<tr>
							<td valign="middle" class="table_right">&nbsp;&nbsp;IP Addr:
								<input type="text" name="snmpv3_trap_ip" value="" maxlength="16" class="input_user" />
							</td>

							<td valign="middle" class="table_right">&nbsp;User Name:
								<input type="text" name="snmp_trap_user" value="" maxlength="16" class="input_user" />
							</td>
							<td valign="middle" class="table_right">&nbsp;Engine ID:
								<input type="text" name="snmp_trap_engineid" value="" maxlength="32"
									class="input_user" />
							</td>

							<td valign="middle" class="table_right" colspan="2">&nbsp;Security level:
								<select name="trap_sec_level" class="select1" style="width:auto;"
									onchange="trap_sec_level_change(this)">
									<option value="0">noAuthNoPriv</option>
									<option value="1">authNoPriv</option>
									<option value="2">authPriv</option>
								</select>
							</td>
						</tr>
						<tr>
							<td valign="middle" class="table_right">&nbsp;&nbsp;Auth algo:
								<select name="trap_auth_algorithm" class="select1">
									<option value="0">md5</option>
									<option value="1">sha</option>
								</select>
							</td>

							<td valign="middle" class="table_right">&nbsp;Auth passwd:
								<input type="text" name="trap_auth_passwd" value="" maxlength="16" class="input_user" />
							</td>

							<td valign="middle" class="table_right">&nbsp;Encryption algo:
								<select name="trap_encryption_algorithm" class="select1">
									<option value="0">des</option>
								</select>
							</td>

							<td valign="middle" class="table_right">&nbsp;Encryption passwd:
								<input type="text" name="trap_encryption_passwd" value="" maxlength="16"
									class="input_user" />
							</td>
						</tr>
						<tr>
							<td colspan="7">
								<table width="1002" border="0" cellpadding="0" cellspacing="1" class="td">
									<tr>
										<td width="150" height="25" class="table_left">&nbsp;&nbsp;Processing list</td>
										<td class="table_right">&nbsp;
											<input type="button" name="trap_user_add" value="add" class="showbtn7"
												onClick="return addTrap_v3_ListItem();" />
											<input type="button" name="trap_user_del" value="del" class="showbtn7"
												onClick="return delTrap_v3_ListItem();" />
										</td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<td colspan="7">
								<table width="1002" border="0" cellspacing="1" cellpadding="0">
									<tr height="8">
										<td width="1001">
											<div style="overflow:hidden;background:#969594;height:1px;"></div>
										</td>
									</tr>
									<tr>
										<td>
											<select name="trap_v3_list" size="10" id="uselect"
												style="width: 1001px;-webkit-appearance: none; box-shadow: none !important;margin:1px;font-size:12px;font-family:Courier New,sans-serif; color:#333333;">
												<option value="0">
													-No.-IP---------------User--------------Level---------Auth---AuthPasswd--------Enc----EncPasswd---------EngineID---------------------------
												</option>
											</select>
										</td>
									</tr>
								</table>
							</td>
						</tr>
					</table>
				</td>
			</tr>


			<tr height="8">
				<td width="1001">
					<div style="overflow:hidden;background:#969594;height:1px;"></div>
				</td>
			</tr>
			<tr align="left" valign="top">
				<td height="50" align="center" valign="top" style="padding-top:5px"><span style="padding-top:5px">
						<input type="Submit" name="Save" value="Save" onClick="return checkData();"
							class="showbtn6">&nbsp;
						<input type="button" name="Cancel" value="Cancel"
							onClick="location.href='setup.cgi?next_file=snmp_cfg_en.html'" class="showbtn6">
					</span></td>
			</tr>
		</table>
		<input type="hidden" name="enableEnglish" value="@enableEnglish#">
		<input type="hidden" name="h_snmp_enable" value="@h_snmp_enable#">
		<input type="hidden" name="h_snmp_version" value="@h_snmp_version#">
		<input type="hidden" name="loader" value="@loader#">
		<input type="hidden" name="snmp_view" value="@snmp_view#">
		<input type="hidden" name="snmp_v1v2c" value="@snmp_v1v2c#">
		<input type="hidden" name="snmp_v3" value="@snmp_v3#">
		<input type="hidden" name="snmp_v1v2c_trap" value="@snmp_v1v2c_trap#">
		<input type="hidden" name="snmp_v3_trap" value="@snmp_v3_trap#">
		<input type="hidden" name="snmp_trap_ip" value="@snmp_trap_ip#">
		<input type="hidden" name="todo" value="save">
		<input type="hidden" name="this_file" value="snmp_cfg.html">
		<input type="hidden" name="next_file" value="snmp_cfg.html">
		<input type="hidden" name="switch_type" value="@switch_type#">
		<input type="hidden" name="this_file1" value="snmp_cfg.html">
		<input type="hidden" name="next_file1" value="snmp_cfg.html">
	</form>
</body>

</html>